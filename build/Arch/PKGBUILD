# Maintainer: Varun M <varunushamurali@gmail.com>

pkgname=mybatop
pkgver=__APP_VERSION__
pkgrel=1
pkgdesc="mybatop continuously monitors laptop battery status and provides detailed analytics through HTML reports."
arch=('any')
url="https://github.com/vishnumur777/mybatop"
license=('GPL-3.0')
depends=('bash' 'systemd' 'dmidecode' 'python' 'python-pandas' 'python-plotly')
source=("$pkgname-$pkgver.tar.gz")
sha256sums=('SKIP')
install=mybatop.install

package() {
  mkdir -p "$pkgdir/opt/mybatop"
  mkdir -p "$pkgdir/etc/systemd/system"
  mkdir -p "$pkgdir/usr/bin"

  # Copy all source files to /opt/mybatop
  cp -r src/mybatop/* "$pkgdir/opt/mybatop/"

  # Install systemd service files (ensure filenames match mybatop-*)
  cp src/mybatop/filesystemd/mybatop-* -t "$pkgdir/etc/systemd/system/"

  # Create correct symlink to the installed script
  ln -s /opt/mybatop/scripts/runscript/mybatop "$pkgdir/usr/bin/mybatop"

  # Set permissions
  chmod -R 755 "$pkgdir/opt/mybatop"
}
